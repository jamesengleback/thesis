1
2
0
2

 

p
e
S
3

 

 
 
]

.

M
B
o
i
b
-
q
[
 
 

1
v
9
3
3
1
0

.

9
0
1
2
:
v
i
X
r
a

Ligand-induced protein dynamics diﬀerences correlate with protein–ligand binding

aﬃnities: An unsupervised deep learning approach

Ikki Yasuda,1 Katsuhiro Endo,1 Eiji Yamamoto,2 Yoshinori Hirano,1, 3 and Kenji Yasuoka1, ∗
1Department of Mechanical Engineering, Keio University, Yokohama, Kanagawa 223-8522, Japan

2Department of System Design Engineering, Keio University, Yokohama, Kanagawa 223-8522, Japan

3Laboratory for Computational Molecular Design,

RIKEN Center for Biosystems Dynamics Research (BDR), Suita, Osaka 565-0874, Japan

Prediction of protein–ligand binding aﬃnity is a major goal in drug discovery. Generally, free
energy gap is calculated between two states (e.g., ligand binding and unbinding). The energy
gap implicitly includes the eﬀects of changes in protein dynamics induced by the binding ligand.
However, the relationship between protein dynamics and binding aﬃnity remains unclear. Here, we
propose a novel method that represents protein behavioral change upon ligand binding with a simple
feature that can be used to predict protein–ligand aﬃnity. From unbiased molecular simulation
data, an unsupervised deep learning method measures the diﬀerences in protein dynamics at a
ligand-binding site depending on the bound ligands. A dimension-reduction method extracts a
dynamic feature that is strongly correlated to the binding aﬃnities. Moreover, the residues that
play important roles in protein–ligand interactions are speciﬁed based on their contribution to the
diﬀerences. These results indicate the potential for dynamics-based drug discovery.

INTRODUCTION

In computational drug discovery, the estimation of
binding aﬃnities between the target proteins and ligands
is one of the main goals. Various approaches have been
proposed and performed for both physics-based and data-
driven methods. In physics-based approaches, protein–
ligand free energy calculations have been widely con-
ducted using free energy perturbation and thermal inte-
gration methods, and the results agree well with exper-
imental data [1–3]. However, despite the high accuracy,
the high-calculation cost has prevented its practical use
[4]. Data-driven approaches, such as scoring functions
for docking, quantitative structure–activity relationship
method with machine learning, and deep learning meth-
ods have been studied over the past few decades [5, 6].
Deep learning approaches can grasp important charac-
teristics automatically from the high-dimensional data of
proteins and ligands. The approaches for protein–ligand
aﬃnity prediction have succeeded in ﬁnding relevant pat-
terns in 3D structures [7–10] and protein and ligand se-
quences [11, 12] using supervised learning with a suﬃ-
cient amount of dataset. Although there are widely used
databases such as PDB-bind [13] and DUD-E [14] for
protein–ligand-binding data, an eﬃcient approach can-
not be determined if the available dataset is limited [15].
Protein dynamics play an important role in biological
phenomena. All-atom molecular dynamics (MD) sim-
ulations are powerful tools that can generate a large
amount of dynamic data and analyze protein dynamics
at the atomic level, along with experimentation [16] and
course-grained computations [17, 18]. MD data analy-
sis for protein dynamics has focused on protein ﬂuctu-
ations, relaxation time, stability, and state transitions.
The commonly used methods are root mean square de-
viation, principal component analysis, relaxation time

analysis, decomposition cross-correlation maps, and root
mean square ﬂuctuation [19–22]. For protein and ligand
systems, these methods have revealed that proteins un-
dergo dynamic changes before and after ligand binding
[23, 24].
In addition to traditional methods, machine
learning approaches have recently been proposed to ob-
tain useful information from MD trajectories of protein
systems [25]. For the description of folding–unfolding
events, VAMPnets [26] could replace handcrafted pro-
cedures for creating a Markov state with deep neural
networks (DNNs). Moreover, an autoencoder that can
detect allosteric dynamics from the time ﬂuctuation of a
protein has been proposed [27].

Although these methods could identify ligand-induced
dynamics changes in proteins, integration of the infor-
mation and representation of the dynamics with a few
variable is still challenging, consequently making it diﬃ-
cult to directly link the dynamics properties with ligand
aﬃnity.
In this study, we propose a novel method to
predict binding energies from proteins’ dynamics change
upon ligand binding, based on a deep learning approach
for MD data analysis [28].
In contrast to general ap-
proaches for MD trajectory-based supervised machine
learning [29, 30], our method uses raw MD trajectories
of a ligand binding site with diﬀerent kinds of ligands,
and quantitatively measures diﬀerences in the dynamics
using unsupervised learning. Overall, the workﬂow con-
sists of simpliﬁcation of MD trajectories as local dynam-
ics ensemble (LDE), calculation of dynamics diﬀerence
as Wasserstein distance, and extraction of variables and
detection of the contributing residues. We veriﬁed the
method in two systems, bromodomain 4 (BRD4) [31, 32]
and protein tyrosine phosphatase 1B (PTP1B) [33, 34]
systems, which have used for benchmark of free energy
calculation in previous studies [1, 3, 35–37]. We illustrate
a strong correlation between the extracted feature and

binding energies, and suggest that the feature relevant
to dynamics can work as a predictor of binding energy.
In addition, the dynamic diﬀerences are interpreted from
potential bindings between speciﬁc residues and ligands.
We believe this approach provides a unique perspective of
ligand-induced dynamics of protein towards a further un-
derstanding of ligand functions and binding mechanism.

RESULTS

Determination of LDE of protein–ligand systems

An overview of our method is shown in Fig. 1. First,
we performed a total of 6.6-µs all-atom MD simulations
[10 ligand-bound (holo) protein and one ligand-unbound
(apo) protein system] to obtain trajectories of the BRD4
systems. To exclude the dependency of the initial con-
ditions, three 200-ns independent production runs were
executed with diﬀerent initial velocities for each system.
To grasp the features of protein dynamics from MD
simulation data within a moderate data size for the DNN,
the concept of LDE [28] was employed. LDE should have
an appropriate selection of particles and time length to
contain important dynamics of interest. We assume that
the behavior of amino acids is sensitive to the presence
of a ligand, that is, the binding site shows representative
dynamics that are induced by ligand interactions and is
suitable target for LDE. The selection of binding sites is
detailed in the Methods section. Furthermore, to reduce
noise and computation cost, the center of mass of the
heavy atoms of each residue in a ligand-binding site were
used as the trajectories of LDE. Notably, this selection
includes no information on the bound ligand, making it
possible to directly compare the behavior of the ligand-
binding sites between systems. As for the time length,
we selected 100-ps order dynamics to capture the side-
chain movements [18], which was suﬃcient to identify
diﬀerences in local dynamics (Fig. S1).

The properties of the LDE with the selection above
are presented in the supplementary material. The value
of g(x) used as characteristics of the dynamics were
distributed similarly regardless of the initial conditions
(Fig. S2). Moreover, the local dynamics were distributed
evenly throughout the MD simulations, suggesting the
fact that they were not inﬂuenced by the slowest ﬂuctu-
ations (Fig. S3). These results indicated that the local
dynamics were robust in terms of the initial conditions
and long-term dynamics.

Calculation of Wasserstein distances using a DNN

To measure diﬀerences in LDE quantitatively, Wasser-
stein distances [38, 39] were calculated using two identical
lobes of a DNN. The input data size for the DNN was

2

(n, ∆, d), where n, ∆, d represent the number of amino
acids in the ligand-binding site, time steps of the LDE,
and dimension, respectively. The time series of dis-
placement vectors of the amino acids from a time step,
x(t0 + ∆) − x(t0), were used as the input, where x(t0)
is the LDE trajectory data, and in the training of the
DNN, t0 was randomly sampled from the total MD sim-
ulation time. Rotation and translation were removed
from the raw trajectories by ﬁtting the conﬁgurations
to an identical structure in the backbone atoms of the
selected residues. The displacement considers the dif-
fusion of residues in the LDE time without the average
structure and slow ﬂuctuations. Wasserstein distances
were calculated for all pairs of N ligand systems, result-
ing in a distance matrix of N × N . It is evident that the
apoprotein system S0 shows a relatively larger distance
from the holoprotein system than that between the holo-
protein and another holoprotein system [Fig. 3(a)].

Extraction of a variable for protein dynamics

The high dimension of the distance matrix makes it
diﬃcult to understand the whole diﬀerences in systems
and extract simple features. Therefore, the distance ma-
trix was embedded into N vectors in a low-dimensional
space that represented the systems. Then, the ﬁrst and
second principal components were extracted.

The distance embedding of LDE demonstrated clear
diﬀerences in protein’s short-term dynamics in the sys-
tems [Fig. 3(b)]. As shown in the distance matrix, the
apoprotein system S0 is separated from the holoproteins.
Moreover, systems with lower-aﬃnity ligands tend to po-
sition near apoprotein compared to systems with higher-
aﬃnity ligands. The link between the ﬁrst principal com-
ponent (PC1) and binding aﬃnities was quantitatively
evaluated by comparing it to the binding energies calcu-
lated in a previous study [1]. Pearson’s product moment
correlation coeﬃcient (r) between PC1 and the binding
energies was 0.82 [Fig. 3(c)].

Contribution of amino acids to dynamic diﬀerences

Given that the features of dynamic diﬀerences could
be an indicator of ligand aﬃnity, speciﬁcation of highly
inﬂuenced amino acids in their dynamics is useful for
understanding the binding mechanism. To analyze the
trajectories in one system, the g(x) was used. When
comparing a pair of systems, the function g(x) can dis-
tinguish characteristic trajectories in a system from those
similar to the other system.

To detect important residues, the amino acids that had
diﬀerent dynamics in the apoprotein system from a holo-
protein system (system 4) were predicted using g(x). In
the embedding ﬁgure, system 4 was the most distant from

3

FIG. 1. The workﬂow to detect diﬀerences in protein dynamics of systems with diﬀerent bound ligands. (a) Molecular dynamics
(MD) simulations for protein–ligand complexes and apoprotein systems. (b) Determination of the local dynamics ensemble
(LDE). (c) Calculation of Wasserstein distances using deep neural networks (DNNs). Wasserstein distances are calculated
for all pairs of system. The output of DNN for each short-term trajectory in system i is denoted as g(xi). The short-term
trajectories expressed in green are characteristic of system i, whereas those in blue are similar to system j. (d) Embedding of
the Wasserstein distance into the lower dimensions and comparing the ﬁrst principal component with the binding energies. (e)
Detection of amino acids whose dynamics are changed by ligand interactions. A trajectory of LDE which consists of short-term
trajectories of multiple residues are decomposed by residues, and their moving distance are compared.

the apoprotein system in PC1. First, g(x) for each short-
term trajectory in the apoprotein system to system 4
was calculated. We note that one short-term trajectory
of LDE contains the dynamics of multiple residues in
the same time frames. Therefore, even if the two short-
term trajectories have the same value, the attributable
residue might be diﬀerent. Second, MD trajectories in
the apoprotein system were grouped into three categories
according to the value of g(x), with the top 5% of g(x)
(high), bottom 5% of g(x) (low), and others (mid). Fi-
nally, the average distances that the center of mass of
each amino acid moved were calculated for each group.

The characteristic behavior in the apoprotein system
demonstrated large movement in all amino acids [Fig.
3(d)], indicating that the apoprotein was more ﬂexible
than the holoprotein. In particular, the residues Trp81,
Val87, Leu92, Leu94, Asp144, and Asp145 showed rel-
atively large gaps between the high and low groups. In
other words, this shows that the behavior in system 4 was
more constrained, which was probably because of ligand
interactions. Thus, these residues may play an impor-
tant role in protein–ligand binding. The mid groups were

calculated to demonstrate that the value of g(x) corre-
sponds to the distances moved by the residues. Other-
wise, g(x) may reﬂects properties such as the direction
of motion.

DISCUSSION

In this study, we presented a deep learning approach
that can determine the diﬀerences in protein behavior as-
sociated with the binding of diﬀerent ligands. MD simu-
lation data of apo and holoprotein systems were reduced
to short-term trajectories of the LDE. Pairwise Wasser-
stein distances were calculated using the DNN. Finally,
the variables were extracted using dimension-reduction
methods for comparison with binding energies, and the
characteristic short-term trajectories in a system were
determined using g(x) for the detection of key residues.
For the BRD4 systems, there was a strong correlation
between PC1 and binding energies. Here, we also inves-
tigated another protein system, tyrosine phosphatase 1
B (PTP1B), in order to assess the potential universality

center of mass ofholoproteins LIG 1Protein AapoproteinLIG 2   n amino acids(sampled randomly)amino acids 1－n(only heavy atoms).b. Selecting local dynamics ensembles (LDE)a. MD simulationsc. Calculating Wasserstein distances chracteristicness of a short-term trajectoryd. Estimating binding energye. Detecting characteristic amino acidsapoprotein systemdistanceresidue number11...ligand-induceed dynamics changechracteristic dynaimcs}4

FIG. 2. The bromodomain 4 (BRD4) system. (a) Ribbon diagram of the conﬁguration of BRD4 (Protein Data Bank ID:
2OSS) superimposed on the molecular surface. The ligand-binding site, residues in the ligand-binding site, and key residues are
shown in green meshed molecular surfaces, green balls and sticks, and green space-ﬁlling with labels, respectively. (b) Chemical
structures of ligands L1–L10. The L1 to L10 labels correspond to the ligands of the 1 to 10 holoprotein systems.

of our method. To obtain trajectories, we performed all-
atom MD simulations of 14 systems of PTP1B [twelve
holo-PTP1B with diﬀerent ligands and two apo-PTP1B
systems (Fig. 4(a))]. For apo-PTP1B, we prepared two
initial structures: the original apo-PTP1B, which was the
X-ray crystallographic structure of the ligand-unbound
form and the pseudo apo-PTP1B, in which the ligand
was removed from the ligand-bound form. Following MD
simulations, the MD data were analyzed in a manner sim-

ilar to the analysis of BRD4. The diﬀerences in the sys-
tems are illustrated in Fig. 4(b). Embedding could iden-
tify apoprotein systems that are quite diﬀerent from the
corresponding holoprotein systems. Furthermore, PC1
showed a strong correlation with binding energies, with
Pearson’s r = 0.72. It should be noted that all ligands
in the prepared PTP1B systems had a relatively high
aﬃnity, which might have made it diﬃcult for dynamic
properties to accurately correspond to binding energies.

5

FIG. 3. Detection of diﬀerences in the protein dynamics of the BRD4 system. (a) Distance matrix calculated using the LDE
distributions. A large Wasserstein distance corresponds to a large diﬀerence in the protein dynamics. (b) Embedding of the
distance matrix. The ﬁrst principal component (PC1) and the second principal component (PC2) from the three-dimension
vectors are shown. Each circle corresponds to a system. Points are colored according to the binding energies, and the apoprotein
system is in black. The binding energies calculated in a previous study were used [1]. (c) Correlation between PC1 and the
binding energies. (d) Moving distance of the center of mass from a reference point in short-term trajectories of the apoprotein
system. System 4 was used as the reference for comparison. Short-term trajectories were divided into three groups based
on g(x). High and low groups consisted of short-term trajectories with top and bottom 5% g(x) values, respectively. The
high group had characteristic trajectories of apoprotein , whereas the low group had similar trajectories to holoprotein. The
distances were averaged over the latter half of the LDE trajectories.

Complexes with a wider range of aﬃnities would be more
desirable. Nonetheless, the calculated dynamic property
tended to reﬂect the aﬃnities of the ligands.

Our method also detected the amino acids that were
inﬂuenced by the ligand, indicating that they may play
important roles in ligand binding. Comparison of apo-
BRD4 dynamics with that of BRD4 bound to ligand 4
indicated that the largest dynamic change occurred at
Trp81, Val87, Leu92, Leu94, Asp144, and Asp145. The
crystal structures showed that these amino acids were
located around the loop domain and were exposed to
solvation (Fig. S4). Combining both observations, we
assume that these residues freely move in an apoprotein,
and the binding of the ligand restricts the movements by
making some interactions. Interestingly, previous studies

have indicated that hydrophobic interactions are likely
to be created with these residues when some types of
ligands are bound [40, 41].
In addition, the hot spots
predicted in those studies largely agreed with the sum
of the dynamics-inﬂuenced residues detected and the di-
rectly binding residues in the crystal structure of system
4 (Pro82, Asn140, and Ile146). Therefore, we could spec-
ify some important residues based on the ligand-induced
dynamics at the residue level.

The main hyperparameters in our method are involved
in MD simulations and LDE selection. First, MD simu-
lations are required to be suﬃciently long to sample the
LDE. The number of data points exponentially reduced
the error in the Wasserstein distances (Fig. S5). Second,
the LDE time length should be selected so that the result-

cS10S0S100107946352186

FIG. 4. Analysis of ligand-induced dynamics in the phosphatase 1 B (PTP1B) systems. (a) Ribbon diagram of the conﬁguration
of PTP1B (Protein Data Bank ID: 1OEM) superimposed on the molecular surface. The ligand-binding site, residues in the
ligand-binding site, and key residues are shown in green meshed molecular surfaces, green balls and sticks, and green space-
ﬁlling with labels, respectively. The labeled residues were selected in a similar manner to BRD4 using g(x). (right column)
Chemical structure of ligands. The binding structures are shown in Fig. S7. (b) Embedding of the distance matrix. The
ﬁrst principal component (PC1) and the second principal component (PC2) from the three-dimension vectors are shown. Each
circle corresponds to a system. Points are colored based on binding energies. The crystal apoprotein system is colored in green,
whereas the pseudo apoprotein system is in black. The binding energies calculated in a previous study were used [37]. (c)
Correlation between PC1 and binding energies.

ing feature corresponds to a property of interest. In the
case of binding aﬃnity, the appropriate length was sug-
gested to be that for the side-chain movement. In Fig.
S6, the results from diﬀerent LDE time are compared,
and the robustness to the selection is shown. Finally, the
selection of binding sites can be addressed by repeating
the process multiple times.
In the initial analysis, the
input residues can be determined based on the distances
to the ligand atoms. The proposed method can detect
potentially important residues.
In subsequent run, the
extracted residues can be used to obtain a feature of the
important protein dynamics.

A point for further improvement is in the identiﬁcation
of ligand-inﬂuenced residues from g(x). Characteristic
dynamics are detected by g(x), and we need to determine
the appropriate measurements for the characteristics. In
the BRD4 systems, the characteristic behavior largely
corresponded to the distances. However, the character-
istic behavior might be more explicit if other criteria are
used, such as the direction of movement.

In conclusion, this study suggests that diﬀerences in
ligand-induced dynamics at a binding site could be an
indicator of protein–ligand binding energies. While our
test cases were relatively rigid proteins that are widely
used as benchmarks for free energy calculation, ﬂexible
proteins are interesting targets for further investigation.
Dynamic properties may play a more important role in
these systems. It has been reported that for a type of
ﬂexible protein, ligand-induced ﬂexibility contributes to
entropy gain in ligand binding, thus leading to higher
aﬃnity and longer residence of the ligands [42]. Further-
more, a similar approach could be used to study other
protein–ligand binding events. For instance, it is inter-
esting to evaluate the relationship between allosteric dy-
namics and ligand function, as has been done in a few
previous studies [20, 29]. Another potential application
would be predicting the eﬀects of protein mutations from
the dynamics of the ligand. In this case, the relationship
between the protein and ligand would be analyzed in a
manner opposite to that employed in the present case;

that is, identical particles of the ligand would be used
for LDE, while the protein molecules would vary slightly
because of the mutation. We believe that the under-
standing of protein dynamics using ligand interactions
will provide deeper insight into the function of ligands,
and dynamics-based approaches would contribute to fur-
ther developments in computational drug discovery.

METHOD

System setup and MD simulations

For the BRD4 systems, the initial structures and
topologies for proteins and ligands were considered ac-
cording to a previous study [1]. The protein structures
with and without ligands were solvated in a TIP3P [43]
cubic box with a minimum distance of 1.0 nm. The sys-
tems were neutralized by adding Na+ or Cl− ions.

All-atom MD simulations of the systems were per-
formed using GROMACS 2019.6 [44]. The particle mesh
Ewald method [45] was used to evaluate the electrostatic
interactions with a cut-oﬀ radius of 1.2 nm, and van der
Waals interactions were switched between 1.0 and 1.2
nm. The bonds with H atoms were constrained with
LINCS [45] in the order of 4. For the prepared systems,
energy minimization was carried out until the maximum
force reduced to less than 10.0 kJ/mol, using the steep-
est descent method. Then restrained MD simulation was
performed in a N V T ensemble for 100 ps and subse-
quently in an N P T constant simulation for 100 ps. Dur-
ing both equilibration processes, position restraints were
executed on the heavy atoms of the ligand and protein
atoms. The temperature and pressure were regulated
using the velocity-rescaling method [46] and Berendsen
methods [47], respectively. Finally, three individual pro-
duction runs were performed for 200 ns in the N P T en-
semble for each system with a random initial velocity
generated to simulate diﬀerent initial conditions. In the
production runs, pressure was controled with Parrinello-
Rahman pressure coupling method [48]. The trajectories
were recorded every 2 ps.

For PTP1B systems, 12 complexes and two types of
apoprotein systems were prepared for MD simulations.
Ten complexes and pseudo-apoprotein systems were con-
structed from the initial structures of PTP1B and the
ligand used in the previous study by Song et. al [36].
In addition, another apoprotein was modeled from the
crystal structure of the PTP1B structure with no ligand
(PDB ID: 1OEM) by homology modeling. Missing atoms
were complemented using MOE [49], where we selected
a structure without the α-helix. To distinguish between
the two apo-protein systems, we denoted the apoprotein
from the study by Song et. al as a pseudo-apo, which is
originally complex and no ligand was added in our study.
We called the apoprotein created from the crystal struc-

7

ture of the apoprotein as a crystal apoprotein. Proteins
and water were parameterized by Amber ﬀ14SB [50] and
TIP3P [43], respectively. The parameters for the ligand
were generated using GAFF[51] and parameter ﬁles in
the study conducted by Song et. al. Subsequently, the
systems were solvated into a cubic box, with the thick-
ness of the water shell set to 1.2 nm. Next, the system
was neutralized with Na+.

MD simulations for PTP1B systems were performed
similarly to the BRD4 systems, except for a few points.
Energy minimization was performed for 10,000 steps, and
the equilibration process was continued for 200 ps in both
the NVT and NPT ensembles. Considering stability, we
removed the ﬁrst 50 ns of the trajectories in the following
deep learning analysis in PTP1B systems.

Selection of the LDE

In BRD4, 14 residues in the binding site were deter-
mined based on the activity ratio in MD simulations
and the previous work by Aldeghi et. al [1]. To ob-
tain the activity ratio for each residue, the distances be-
tween the heavy atoms of the protein and those of the
ligand were calculated. We deﬁned the activity ratio as
Ncontact/Ntotal, where Ncontact is the number of frames
in which the residues are in contact with the ligand, and
Ntotal is the total number of output frames of the MD
simulation. The protein–ligand contact was conﬁrmed if
any heavy atom of the residue was positioned within a
distance r from any of the ligand heavy atoms, where r
was set to 0.5 nm. Residues that showed an activity ra-
tio of more than 0.5 were regarded as binding residues.
Activity ratio was calculated for the three simulations
for each system, and the sum of the satisfactory residues
were used.
In addition to the distance-based criteria,
the selection of binding site residues by Aldeghi et. al
was considered to further limit the number of binding
site residues for input. All residues from the selection of
Aldeghi et. al satisﬁed the distance-based criteria. Based
on these two criteria, 14 residues were selected (Trp81,
Pro82, Phe83, Val87, Leu92, Leu94, Tyr97, Cyc136,
Tyr139, Asn140, Asp144, Asp145, Ile146, and Met149).
For PTP1B systems, the binding site residues were
determined in a manner similar to that for the BRD4
systems. The values of the contact distance and activ-
ity ratio were identical to those of BRD4 systems, and
we referred to the previous study conducted by Liu et
al.
[52]. Nineteen residues were chosen as binding sites
(Tyr46, Asp48, Val49, Lys120, Pro180, Asp181, Phe182,
Gly183, Cys215, Ser216, Ala217, Ile219, Gly220, Arg221,
Arg254, Met258, Gly259, Gln262, and Gln266).
In both cases, the time length of the LDE was set to
128 ps (= 2 ps × 64 steps), which presumably corre-
sponded to the scale of the side-chain movement.

Wasserstein distance between systems and its

calculation using DNN

The Wasserstein distance between two LDEs is ex-

pressed as

Wij = sup
||f||L≤1

Ex∼yi [f (x)] − Ex∼yj [f (x)]

(1)

where i, j are the indexes for the systems, supremum is
over all the 1-Lipschitz function f , x is the short-term
trajectory of the LDE, and yi is the LDE of system i.
The function f is expressed by the DNN, and using the
trained function f∗, Wij is described as

Wij = Ex∼yi [f∗(x)] − Ex∼yj [f∗(x)] .

(2)

The architecture of the DNN is almost identical to that
of the previous study by Endo et. al [28], except for two
changes. First, the input size was changed to n × 64 × d,
where n and d are the number of amino acids in the
LDE and dimension, respectively. Second, the number of
nodes was increased to 2048 to adapt to the complexity
of the protein systems.

During the training, LDE trajectories were randomly

obtained from the three simulations for each system.

Embedding of Wasserstein distances

A Wasserstein distance matrix was embedded into vec-
tors in low-dimensional space to satisfy the following
equation:

p0, p1, ..., pn = arg min
p0,p1,...,pn

(Wi,j − ||pi − pj||)2

(3)

(cid:88)

i,j

where pi is an n-dimensional vector that corresponds to
system i. In this study, the number of dimensions was
set to three. The embedded vectors were optimized us-
ing simulated annealing and gradient descent. Simulated
annealing was employed to explore the global minimum
and gradient descent for fast convergence.

A function g(x)

A function g(xi) [28] represents the contribution of one
trajectory fraction to the overall diﬀerences between two
systems. The deﬁnition for a LDE trajectory of system i
with the referenced system j is expressed as

g(xi) = Ex(cid:48)∼yj [f∗(xi) − f∗(x(cid:48))] .

This is equivalent to

Wij = Ex(cid:48)∼yj [g(x(cid:48)

i)] .

(4)

(5)

8

The calculation was performed using the output of DNN
when the input are one short-term trajectory of one sys-
tem i and the average local dynamics of the other system
j in a pair. The value of g(x) could be used to evaluate
one short-term trajectory from a system in the perspec-
tive of how much similar they are to the overall dynamics
of the other system. For instance, if a short-term trajec-
tory in system i has a small g(x) when system j is ref-
erenced, the short-term trajectory of system i is similar
to the average molecular behavior seen in system j and
vice versa. g(x) was calculated every 64 steps.

ACKNOWLEDGEMENTS

AUTHOR CONTRIBUTIONS

K.E., E.Y., and K.Y. conceptualized the research. I.Y.
and Y.H. performed the simulations. I.Y and K.E. an-
alyzed the data. I.Y., K.E., E.Y., Y.H. and K.Y. wrote
and edited the manuscript.

∗ yasuoka@mech.keio.ac.jp
[1] M. Aldeghi, A. Heifetz, M. J. Bodkin, S. Knapp, and
P. C. Biggin, Accurate calculation of the absolute free
energy of binding for drug molecules, Chemical science
7, 207 (2016).

[2] Z. Cournia, B. Allen, and W. Sherman, Relative bind-
ing free energy calculations in drug discovery: recent ad-
vances and practical considerations, Journal of chemical
information and modeling 57, 2911 (2017).

[3] V. Gapsys, L. P´erez-Benito, M. Aldeghi, D. Seeliger,
H. Van Vlijmen, G. Tresadern, and B. L. de Groot, Large
scale relative protein ligand binding aﬃnities using non-
equilibrium alchemy, Chemical Science 11, 1140 (2020).
[4] R. Abel, L. Wang, E. D. Harder, B. Berne, and R. A.
Friesner, Advancing drug discovery through enhanced
free energy calculations, Accounts of chemical research
50, 1625 (2017).

[5] L. Zhang, J. Tan, D. Han, and H. Zhu, From machine
learning to deep learning: progress in machine intelli-
gence for rational drug discovery, Drug discovery today
22, 1680 (2017).

[6] C. Shen, J. Ding, Z. Wang, D. Cao, X. Ding, and T. Hou,
From machine learning to deep learning: Advances in
scoring functions for protein–ligand docking, Wiley Inter-
disciplinary Reviews: Computational Molecular Science
10, e1429 (2020).

[7] J. Gomes, B. Ramsundar, E. N. Feinberg, and
V. S. Pande, Atomic convolutional networks for pre-
dicting protein-ligand binding aﬃnity, arXiv preprint
arXiv:1703.10603 (2017).

[8] J. Jim´enez, M. Skalic, G. Martinez-Rosell, and
G. De Fabritiis, K deep: protein–ligand absolute binding
aﬃnity prediction via 3d-convolutional neural networks,
Journal of chemical information and modeling 58, 287
(2018).

[9] Z. Cang, L. Mu, and G.-W. Wei, Representability of alge-
braic topology for biomolecules in machine learning based
scoring and virtual screening, PLoS computational biol-
ogy 14, e1005929 (2018).

[10] M. M. Stepniewska-Dziubinska, P. Zielenkiewicz, and
P. Siedlecki, Development and evaluation of a deep learn-
ing model for protein–ligand binding aﬃnity prediction,
Bioinformatics 34, 3666 (2018).

[11] H. ¨Ozt¨urk, A. ¨Ozg¨ur, and E. Ozkirimli, Deepdta: deep
drug–target binding aﬃnity prediction, Bioinformatics
34, i821 (2018).

[12] M. Karimi, D. Wu, Z. Wang, and Y. Shen, Deepaﬃnity:
interpretable deep learning of compound–protein aﬃnity
through uniﬁed recurrent and convolutional neural net-
works, Bioinformatics 35, 3329 (2019).

[13] R. Wang, X. Fang, Y. Lu, and S. Wang, The pdbbind
database: Collection of binding aﬃnities for protein- lig-
and complexes with known three-dimensional structures,
Journal of medicinal chemistry 47, 2977 (2004).

[14] N. Huang, B. K. Shoichet, and J. J. Irwin, Benchmarking
sets for molecular docking, Journal of medicinal chem-
istry 49, 6789 (2006).

[15] Q. Shi, W. Chen, S. Huang, Y. Wang, and Z. Xue, Deep
learning for mining protein data, Brieﬁngs in bioinfor-
matics 22, 194 (2021).

[16] R. Fernandez-Leiro and S. H. Scheres, Unravelling bi-
ological macromolecules with cryo-electron microscopy,
Nature 537, 339 (2016).

[17] I. Bahar, T. R. Lezon, L.-W. Yang, and E. Eyal, Global
dynamics of proteins: bridging between structure and
function, Annual review of biophysics 39, 23 (2010).

[18] I. Bahar, T. R. Lezon, A. Bakan, and I. H. Shrivastava,
Normal mode analysis of biomolecular structures: func-
tional mechanisms of membrane proteins, Chemical re-
views 110, 1463 (2010).

[19] J.-F. Yang, F. Wang, Y.-Z. Chen, G.-F. Hao, and G.-F.
Yang, Larmd:
integration of bioinformatic resources to
proﬁle ligand-driven protein dynamics with a case on the
activation of estrogen receptor, Brieﬁngs in Bioinformat-
ics 21, 2206 (2020).

[20] Y. Jin, M. Duan, X. Wang, X. Kong, W. Zhou, H. Sun,
H. Liu, D. Li, H. Yu, Y. Li, et al., Communication
between the ligand-binding pocket and the activation
function-2 domain of androgen receptor revealed by
molecular dynamics simulations, Journal of chemical in-
formation and modeling 59, 842 (2019).

[21] E. Yamamoto, T. Akimoto, A. Mitsutake, and R. Met-
zler, Universal relation between instantaneous diﬀusivity
and radius of gyration of proteins in aqueous solution,
Physical review letters 126, 128101 (2021).

[22] A. Mitsutake, H. Iijima, and H. Takano, Relaxation mode
analysis of a peptide system: Comparison with princi-
pal component analysis, The Journal of chemical physics
135, 10B623 (2011).

[23] T. S. Komatsu, N. Okimoto, Y. M. Koyama, Y. Hirano,
G. Morimoto, Y. Ohno, and M. Taiji, Drug binding dy-
namics of the dimeric sars-cov-2 main protease, deter-
mined by molecular dynamics simulation, Scientiﬁc re-
ports 10, 1 (2020).

[24] N. Stanley, L. Pardo, and G. De Fabritiis, The pathway
of ligand entry from the membrane bilayer to a lipid g
protein-coupled receptor, Scientiﬁc reports 6, 1 (2016).

9

[25] F. No´e, A. Tkatchenko, K.-R. M¨uller, and C. Clementi,
Machine learning for molecular simulation, Annual re-
view of physical chemistry 71, 361 (2020).

[26] A. Mardt, L. Pasquali, H. Wu, and F. No´e, Vampnets for
deep learning of molecular kinetics, Nature communica-
tions 9, 1 (2018).

[27] Y. Tsuchiya, K. Taneishi,

and Y. Yonezawa,
allostery
Autoencoder-based detection of dynamic
triggered by ligand binding based on molecular dynam-
ics, Journal of chemical information and modeling 59,
4043 (2019).

[28] K. Endo, D. Yuhara, K. Tomobe, and K. Yasuoka, De-
tection of molecular behavior that characterizes systems
using a deep learning approach, Nanoscale 11, 10064
(2019).

[29] M. Ferraro, E. Moroni, E.

Ippoliti, S. Rinaldi,
C. Sanchez-Martin, A. Rasola, L. F. Pavarino, and
G. Colombo, Machine learning of allosteric eﬀects: the
analysis of ligand-induced dynamics to predict functional
eﬀects in trap1, The Journal of Physical Chemistry B
125, 101 (2020).

[30] S. Riniker, Molecular dynamics ﬁngerprints (mdfp): ma-
chine learning from md data to predict free-energy dif-
ferences, Journal of chemical information and modeling
57, 726 (2017).

[31] T. Fujisawa and P. Filippakopoulos, Functions of
bromodomain-containing proteins and their roles in
homeostasis and cancer, Nature reviews Molecular cell
biology 18, 246 (2017).

[32] A. G. Cochran, A. R. Conery, and R. J. Sims, Bromod-
omains: a new target class for drug development, Nature
Reviews Drug Discovery 18, 609 (2019).

[33] T. O. Johnson, J. Ermolieﬀ, and M. R. Jirousek, Protein
tyrosine phosphatase 1b inhibitors for diabetes, Nature
Reviews Drug Discovery 1, 696 (2002).

[34] M. Verma, S. J. Gupta, A. Chaudhary, and V. K. Garg,
Protein tyrosine phosphatase 1b inhibitors as antidia-
betic agents–a brief review, Bioorganic chemistry 70, 267
(2017).

[35] L. Wang, Y. Wu, Y. Deng, B. Kim, L. Pierce, G. Krilov,
D. Lupyan, S. Robinson, M. K. Dahlgren, J. Greenwood,
et al., Accurate and reliable prediction of relative ligand
binding potency in prospective drug discovery by way
of a modern free-energy calculation protocol and force
ﬁeld, Journal of the American Chemical Society 137,
2695 (2015).

[36] L. F. Song, T.-S. Lee, C. Zhu, D. M. York, and K. M.
Merz Jr, Using amber18 for relative free energy calcula-
tions, Journal of chemical information and modeling 59,
3128 (2019).

[37] X. He, S. Liu, T.-S. Lee, B. Ji, V. H. Man, D. M. York,
and J. Wang, Fast, accurate, and reliable protocols for
routine calculations of protein–ligand binding aﬃnities in
drug design projects using amber gpu-ti with ﬀ14sb/gaﬀ,
ACS omega 5, 4611 (2020).

[38] C. Villani, Optimal transport: old and new, Vol. 338

(Springer, 2009).

[39] M. Arjovsky, S. Chintala, and L. Bottou, Wasserstein
generative adversarial networks, in International confer-
ence on machine learning (PMLR, 2017) pp. 214–223.

[40] T. Ran, Z. Zhang, K. Liu, Y. Lu, H. Li, J. Xu, X. Xiong,
Y. Zhang, A. Xu, S. Lu, et al., Insight into the key inter-
actions of bromodomain inhibitors based on molecular
docking, interaction ﬁngerprinting, molecular dynamics

10

and binding free energy calculation, Molecular bioSys-
tems 11, 1295 (2015).

[41] L. Wang, Y. Wang, H. Sun, J. Zhao, and Q. Wang,
Theoretical
insight into molecular mechanisms of in-
hibitor bindings to bromodomain-containing protein 4
using molecular dynamics simulations and calculations
of binding free energies, Chemical Physics Letters 736,
136785 (2019).

[42] M. Amaral, D. Kokh, J. Bomke, A. Wegener, H. Buch-
staller, H. Eggenweiler, P. Matias, C. Sirrenberg,
R. Wade, and M. Frech, Protein conformational ﬂexi-
bility modulates kinetics and thermodynamics of drug
binding, Nature communications 8, 1 (2017).

[43] W. L. Jorgensen, J. Chandrasekhar, J. D. Madura, R. W.
Impey, and M. L. Klein, Comparison of simple poten-
tial functions for simulating liquid water, The Journal of
chemical physics 79, 926 (1983).

[44] M. J. Abraham, T. Murtola, R. Schulz, S. P´all, J. C.
Smith, B. Hess, and E. Lindahl, Gromacs: High perfor-
mance molecular simulations through multi-level paral-
lelism from laptops to supercomputers, SoftwareX 1, 19
(2015).

[45] B. Hess, H. Bekker, H. J. Berendsen, and J. G. Fraaije,
Lincs: a linear constraint solver for molecular simu-
lations, Journal of computational chemistry 18, 1463

(1997).

[46] G. Bussi, D. Donadio, and M. Parrinello, Canonical sam-
pling through velocity rescaling, The Journal of chemical
physics 126, 014101 (2007).

[47] P. Gros, W. F. van Gunsteren, and W. Hol, Inclusion
of thermal motion in crystallographic structures by re-
strained molecular dynamics, Science 249, 1149 (1990).
[48] M. Parrinello and A. Rahman, Polymorphic transitions
in single crystals: A new molecular dynamics method,
Journal of Applied physics 52, 7182 (1981).

[49] C. C. G. Inc, Molecular operating environment (moe)

(2016).

[50] J. A. Maier, C. Martinez, K. Kasavajhala, L. Wickstrom,
K. E. Hauser, and C. Simmerling, ﬀ14sb: improving the
accuracy of protein side chain and backbone parameters
from ﬀ99sb, Journal of chemical theory and computation
11, 3696 (2015).

[51] J. Wang, W. Wang, P. A. Kollman, and D. A. Case, Auto-
matic atom type and bond type perception in molecular
mechanical calculations, Journal of molecular graphics
and modelling 25, 247 (2006).

[52] M. Liu, L. Wang, X. Sun, and X. Zhao, Investigating
the impact of asp181 point mutations on interactions be-
tween ptp1b and phosphotyrosine substrate, Scientiﬁc re-
ports 4, 1 (2014).

