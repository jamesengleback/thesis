doi:10.1016/j.jmb.2008.11.010

J. Mol. Biol. (2009) 385, 381–392

Available online at www.sciencedirect.com

ROSETTALIGAND Docking with Full Ligand
and Receptor Flexibility
Ian W. Davis1 and David Baker1,2⁎

1Department of Biochemistry,
University of Washington,
Seattle, WA 98195-7350, USA
2Howard Hughes Medical
Institute, University of
Washington, Seattle, WA
98195-7350, USA
Received 18 August 2008;
received in revised form
7 November 2008;
accepted 10 November 2008
Available online
18 November 2008

Edited by D. Case

Introduction

Computational docking of small-molecule ligands into protein receptors is
an important tool for modern drug discovery. Although conformational
adjustments are frequently observed between the free and ligand-bound
states, the conformational flexibility of the protein is typically ignored in
protein–small molecule docking programs. We previously described the
program ROSETTALIGAND, which leverages the Rosetta energy function and
side-chain repacking algorithm to account for flexibility of all side chains in
the binding site. Here we present extensions to ROSETTALIGAND that incor-
porate full
ligand flexibility as well as receptor backbone flexibility.
Including receptor backbone flexibility is found to produce more correct
docked complexes and to lower the average RMSD of the best-scoring
docked poses relative to the rigid-backbone results. On a challenging set of
retrospective and prospective cross-docking tests, we find that the top-
scoring ligand pose is correctly positioned within 2 Å RMSD for 64% (54/85)
of cases overall.

© 2008 Elsevier Ltd. All rights reserved.
Keywords: small-molecule docking; protein flexibility; backbone flexibility;
Rosetta

Many biochemical processes depend on the
specific interactions between protein receptors and
their small-molecule ligands—metabolites, cofac-
tors, hormones, and drugs. Knowledge of the atomic
interactions involved is useful both for understand-
ing natural processes and for engineering new
therapeutics, but experimentally determining struc-
tures of complexes can be difficult, time-consuming,
and expensive. Thus, a variety of programs have
been developed to computationally “dock” recep-
tors with ligands at varying levels of detail.

Docking programs often ignore conformational
changes in the protein receptor, although these are
frequently observed upon binding. Better modeling
of receptor flexibility is one of the major challenges for
the field.1,2 Of methods that do account for receptor
flexibility, most require significant prior knowledge of
the system. For instance, 21 different crystal structures
were used to generate composite energy grids for

*Corresponding author. Department of Biochemistry,

University of Washington, Seattle, WA 98195-7350, USA.
E-mail address: dabaker@u.washington.edu.

Abbreviations used: JNK3, c-Jun N-terminal kinase 3;

MCM, Monte Carlo minimization.

0022-2836/$ - see front matter © 2008 Elsevier Ltd. All rights reserved.

docking into HIV-1 protease with AutoDock.3 Simi-
larly, FlexE can combine parts from multiple struc-
tures during docking.4 On the other hand, FLIPDock
allows many kinds of flexibility to be modeled de novo,
but each degree of
freedom must be selected
manually.5 Likewise,
the Glide/Prime method
needs only one starting structure, but flexibility is
initially modeled simply by truncating three or fewer
selected side chains to alanine.6 Such methods are
least useful in situations where docking could be most
informative: where binding involves interactions and
conformations that have not been observed pre-
viously and thus could not have been easily foreseen.
Many approaches to docking with receptor flexi-
bility have been recently reviewed by Cozzini and
colleagues,7 with a focus on either coarse-grained or
atomistic molecular dynamics calculations to gen-
erate ensembles of receptor structures. Separate
docking calculations can be carried out on each
member of the ensemble, or the receptor–ligand
energy landscapes can be combined into an ensem-
ble average. Neither approach is perfect: in separate
docking, the individual structures constitute only a
tiny fraction of all low-energy receptor conforma-
tions (even if the algorithm recombines the struc-
tures on the fly), while averaging may lead to ligand
poses that are not compatible with any real receptor
state.7 Both approaches also implicitly assume the

382

ROSETTALIGAND Flexible Receptor Docking

Table 1. Impact of initial ligand placement and receptor backbone flexibility on the Meiler and Baker cross-docking test
set

Simple protocol

RMS of
#1 (Å)

Self
7.48
0.97

0.55
1.25

5.59
7.78

3.18
1.20

1.21
2.22

1.21
0.70

2.22
0.70

7.61
4.37

0.90
4.63

5.27
1.22

Cross
5.40
6.28

1.59
5.77

3.85
7.54

2.33
8.80

3.76
4.34

1.47
1.43

3.49
8.10

6.37
8.94

6.31
0.52

1.25
2.12

Receptor
1aq1
1dm2

1dbj
2dbl

1dwc
1dwd

1fm9
2prg

1p8d
1pq6

1p8d
1pqc

1pq6
1pqc

1ppc
1pph

2ctc
7cpa

4tim
6tim

Rank b2 Å
Self Cross
2
1

2
—

1
1

—
—

—
1

1
3

1
1

3
1

—
—

1
—

2
1

1
3

—
—

2
—

78
7

1
1

12
93

—
—

—
1

1
5

Rigid-backbone protocol
RMS of
#1 (Å)

Rank b2 Å
Self Cross
1
1

1
—

Self
1.39
0.82

0.38
1.24

7.05
1.40

5.90
8.28

1.49
2.05

1.49
0.49

2.05
0.49

3.16
0.90

0.70
4.30

1.07
1.16

Cross
0.80
6.22

0.94
0.58

6.88
1.48

8.35
10.62

2.06
1.20

1.78
0.98

3.46
3.70

4.39
3.04

1
1

2
1

19
17

1
11

1
1

11
1

4
1

8.49
1
4.51 —

1.35
2.13

1
1

1
1

—
1

18
—

158
1

1
1

7
181

2
8

—
3

1
7

Flexible-backbone protocol

AutoDock 4.0

RMS of
#1 (Å)

Self
1.39
1.14

0.46
1.35

1.15
4.47

5.72
8.30

1.39
2.08

1.39
0.53

2.08
0.53

1.62
1.00

0.73
4.62

0.95
1.25

Cross
0.42
1.36

1.22
0.85

8.23
1.34

8.39
4.07

2.24
1.27

2.29
0.98

3.61
2.20

1.16
5.63

3.64
4.60

1.34
0.70

Rank b 2 Å
Self Cross
1
1

1
1

1
1

1
15

11
5

1
3

1
1

3
1

1
1

1
—

1
1

1
1

—
1

2
34

6
1

19
1

25
128

1
2

—
4

1
1

RMS of
#1 (Å)

Self
0.43
0.52

0.90
1.26

5.92
4.01

3.09
2.77

2.11
1.45

2.11
1.62

1.45
1.62

3.69
0.75

5.07
6.25

1.39
1.19

Cross
3.80
0.67

1.22
0.96

2.64
5.76

4.20
4.57

4.82
2.91

4.42
4.57

3.65
2.73

2.64
3.93

4.44
5.04

1.37
2.58

Rank b 2 Å
Self Cross
1
1

—
1

1
1

—
19

—
6

22
1

22
1

1
1

4
1

28
—

1
1

1
1

4
—

14
—

2
48

7
—

45
—

—
8

—
36

1
—

4.48

3.01

Average
Ten pairs of proteins were docked against their own co-crystalized ligand (“self”) or the ligand from the other structure (“cross”). “RMS of
#1” denotes the RMSD of ligand heavy atom positions versus the crystal structure, for the best-scoring docked pose. “Rank b2 Å” gives
the rank of the first pose to get within 2 Å RMSD of the crystal structure; some pairs did not have a pose under 2 Å within the top 5% of
structures produced. See the text for description of the protocols.

3.35

2.29

3.65

2.78

2.38

2.11

ligand-bound conformation is sufficiently low
energy in the absence of the ligand to be included
in the ensemble. Nonetheless, these approaches
have improved performance in some cases.3,8

Here we describe a new approach to protein–
ligand docking that explicitly models full side-chain,
backbone, and ligand flexibility with ligand and
receptor degrees of freedom explored simulta-
neously. The new method is an extension of the
ROSETTALIGAND algorithm, which uses Monte Carlo
sampling and the Rosetta full-atom energy function.
We analyze the performance of the new method on
an extensive set of retrospective and prospective
cross-docking scenarios and find it competitive with
and possibly superior to the best existing methods.

Results

As described in Materials and Methods, we have
made important enhancements to the ROSETTALIGAND
docking program, notably the inclusion of full ligand
flexibility (conformers plus torsional minimization),
better initial ligand placement, and receptor backbone
flexibility. Here we demonstrate, with both retro-

spective and prospective tests, that these features
improve the accuracy of ROSETTALIGAND docking pre-
dictions. The retrospective assessment used the
Meiler and Baker set: 10 pairs of co-crystallized
receptor–ligand structures from our previous work,9
which allow for self- and cross-docking experiments
within each pairing. Many of them are quite challen-
ging, with large, flexible ligands and multiple side
chains changing rotamer. This set was used repeat-
edly to test the effectiveness of various algorithms.
The prospective assessment was conducted as part of
the community-wide Statistical Assessment of the
Modeling of Proteins and Ligands (SAMPL-1) blind-
docking experiment (see Materials and Methods)†.
The challenge was to dock nearly 100 ligands into
representative structures of their cognate receptors [c-
Jun N-terminal kinase 3 (JNK3) kinase and urokinase-
type plasminogen activator]. We made truly blind
predictions during SAMPL, but the initial coarse-
grained ligand placement and backbone flexibility
features were not implemented at that time. We

† http://sampl.eyesopen.com/

ROSETTALIGAND Flexible Receptor Docking

383

reevaluated our final method with these features on
this set a few months later, but we did not use it for
testing in between, and there was no human inter-
vention in the second docking run. Thus, we believe
this provides a fair and nearly blind assessment of the
current version of ROSETTALIGAND.

Meiler and Baker cross-docking

Table 1 shows the impact of initial ligand place-
ment and receptor backbone flexibility on the Meiler
and Baker set. The “simple protocol” is similar to the

original ROSETTALIGAND in that the ligand is placed
randomly in a sphere centered on the binding site
and the backbone is held fixed throughout. The
“rigid-backbone protocol” adds the coarse screen for
initial
ligand placement, which only accepts as
starting points those poses with good ligand–
receptor shape complementarity. Finally, the “flex-
ible-backbone protocol” adds the restrained mini-
mization of the receptor backbone at the end of every
docking trajectory.

Better initial ligand placement means more search
effort is focused in plausible regions of the energy

Fig. 1. Challenges in searching ligand conformations. (a) Docking the 1ppc ligand into the 1pph receptor. The actual
binding mode (green) requires fitting the ligand into three separate pockets, successful in the cyan docked pose. Without
the initial shape complementarity search, typically only two of the three pockets are filled (purple). (b) Generating the
bioactive conformation of the flexible 1pq6 ligand is difficult. The nearest conformers generated by Omega (cyan, purple)
fill roughly the same space as the native (green) but do not make the same chemical interactions. (c) Including side-chain
flexibility is important for capturing the native binding mode of ligand 56 for JNK3 kinase (purple). Only two hydrogen
bonds hold it in place, and in the provided SAMPL crystal structure Asn152 (green, at lower left) is pointed out into
solvent. (d) The narrow binding cleft of JNK3 kinase requires precise ligand placement, particularly for large, flexible ones
like compound 8. Random attempts at placement generally leave one end of the ligand projecting into solvent (purple),
but the initial shape complementarity search guides docked poses (cyan) into the native binding mode (green).

384

ROSETTALIGAND Flexible Receptor Docking

landscape. As a result, the program is more likely to
sample closer to the true binding mode. Thus, more
cases have the lowest-energy structure within 2 Å of
the native structure, and the average RMSD to the

native structure decreases. Also, more cases have
some low-energy predictions with RMSD b2 Å,
even if the single lowest-energy prediction is not.
Not surprisingly, ROSETTALIGAND performs better

Fig. 2. Impact of backbone flexibility on 1dm2/1aq1 (CDK2/staurosporine). (a) The rigid-backbone algorithm (left)
does sample poses (light circles) near the native (black dots), but clashes with the receptor backbone make them
significantly less favorable than the lowest-energy poses (dark circles). (b) The predicted pose (black cross/purple sticks)
is docked in the mouth of the binding pocket, far from the native binding mode (green sticks). (c) By allowing a small
amount of backbone flexibility for the receptor (right), near-native poses are identified as the lowest in energy. (d) Two
low-energy predictions (cyan, purple) show that relatively small backbone changes occur relative to the crystal structure
(green), yet the consequences for scoring are tremendous.

ROSETTALIGAND Flexible Receptor Docking

385

on the self-docking cases than the cross-docking
ones, but
the improvement afforded by better
ligand placement is evident for both.

is unlikely to find all

Figure 1a shows the 1pph/1ppc (trypsin) cross-
docking case, which benefits from the initial shape
complementarity search. This ligand has three
arms that fit tightly in distinct pockets. Totally
random placement
three
interactions, so even the best predictions generally
have one arm projecting into solvent (purple). The
initial rough screen for shape matches, however,
narrows the search space and leads to docking
conformations (cyan) that match the native (green).
Another example is shown in Fig. 1d (JNK3
kinase), where a long, flexible ligand must fold
into a Z shape. Again, the highly specific sterics of
this pocket produce a narrow funnel in the energy
landscape, one that is difficult to discover (purple)
without
focusing the search on plausible poses
(cyan).

In contrast to ligand placement, which makes the
introducing receptor
search process more efficient,
backbone flexibility actually alters the receptor–ligand
energy landscape. Again, compared to the rigid-back-
bone protocol, there are more cases in which docked
models are within 2 Å of the native complex and there
are more cases in which the lowest-energy model is
within 2 Å. The average RMSD also drops again,
although by a smaller amount.

Figure 2 shows a particularly dramatic example
the benefits of backbone minimization. This
of
receptor structure was determined with a smaller
ligand bound, so the binding site had closed in
slightly. The docked ligand, being rigid and some-
what larger, clashed with the receptor even after
side-chain and ligand torsions were minimized.
Note that even the minimized native pose has
positive binding energies (steric clashes), and
although some docking trajectories sampled near
the native pose, their energies kept them out of the
5% lowest-energy structures. Instead, the ligand
preferred to stick in the mouth of the pocket. On the
other hand, allowing the backbone to relax even a
small amount allowed a near-native pose to be
recognized as lower in energy.

in correctly docking the ligands,

While backbone and side-chain flexibility were
helpful
the
magnitude of changes in the receptors was small,
as suggested by Fig. 2. Within 6 Å of the ligand, the
average RMSDs between the lowest-energy models
and their starting structures were 0.45 Å over
backbone atoms and 0.88 Å over all atoms (0.7
and 1.7 Å maximum, respectively). The RMSDs
between the pairs of starting structures span the
same ranges. On average, backbone flexibility did
not
improve receptor RMSD to the co-crystal
complex, possibly because the changes that enabled
correct ligand docking were balanced by spurious
changes elsewhere. Regardless, the rugged energy
landscape created by hydrogen bonding and
repulsive van der Waals terms means that these
small conformational changes can have a large
impact on docking success.

Table 2. Impact of initial ligand placement and receptor
backbone flexibility on JNK3 kinase targets from the
SAMPL-1 blind docking challenge

SAMPL-1
predictions

Flexible backbone
RMS
of best Rank b 2 Å

NA⁎

1
1
1
22
9

6
4
5
5
4
5
5
5
3
4
7
7
4
3
5
4
5
3
4
6
3
6
7
4
4
5
5
6
8
4
3
1
5
6
4
5
4
5

1
1
1
6
2
21⁎
1
NA
4
1
1
1
1
NA
1
1
4
6

1
1
1
1
1
1
2
1
1
1
2
1
1
23
1
1
1
31
1
NA
1
1
1
1
1
1
1
1
NA
2
1
1
NA
1
2
1
7
NA

1.17
0.51
1.00
0.73
1.92
0.96
1.07
0.71
1.22
0.36
1.19
0.67
0.47
2.70
0.67
0.71
0.50
3.41
0.45
2.78
0.71
0.65
1.27
0.83
0.68
0.64
1.13
0.85
5.34
1.21
0.96
1.33
6.89
1.01
0.73
0.66
0.98
5.28
0.84
0.89
1.43

RMS
of best Rank b 2 Å
0.84
1.40
1.07
3.40
2.23
1.10
0.91
0.74
1.28
4.00
0.94
0.64
1.55
5.56
0.69
0.61
0.90
0.79
1.39
3.44
0.89
0.87
2.25
2.48
0.47
0.55
1.52
0.95
4.89
5.81
1.15
1.39
0.64
1.92
9.47
4.18
10.91
10.61
0.66
0.74
2.49

Compound Torsions
jnk.pp.1-1
jnk.pp.1-3
jnk.pp.1-7
jnk.pp.1-8
jnk.pp.1-9
jnk.pp.1-10
jnk.pp.1-11
jnk.pp.1-12
jnk.pp.1-14
jnk.pp.1-15
jnk.pp.1-18
jnk.pp.1-19
jnk.pp.1-22
jnk.pp.1-24
jnk.pp.1-25
jnk.pp.1-26
jnk.pp.1-27
jnk.pp.1-28
jnk.pp.1-32
jnk.pp.1-33
jnk.pp.1-34
jnk.pp.1-35
jnk.pp.1-37
jnk.pp.1-38
jnk.pp.1-39
jnk.pp.1-40
jnk.pp.1-41
jnk.pp.1-42
jnk.pp.1-46
jnk.pp.1-48
jnk.pp.1-49
jnk.pp.1-51
jnk.pp.1-52
jnk.pp.1-55
jnk.pp.1-56
jnk.pp.1-59
jnk.pp.1-60
jnk.pp.1-62
#1 b 2 Å
#1 b 3 Å
Avg. RMS
“RMS of best” denotes the RMSD of ligand heavy-atom positions
versus the crystal structure for the best of the three highest-scoring
docked poses. “Rank b2 Å” gives the rank of the first pose to be
within 2 Å RMSD of the crystal structure; some pairs did not have
a pose under 2 Å within the top 5% of structures produced.
Compounds marked with asterisks were eventually positioned
manually in the binding site for the actual SAMPL-1 predictions;
all docking was fully automatic with the flexible-backbone
protocol. Decoy ligands were not included in the table, giving
rise to discontinuous compound numbering. See the text for
description of the protocols.

1
NA
5
1
1
1
1
6
3
20
NA

NA⁎
NA⁎
NA⁎

SAMPL-1 cross-docking

Tables 2 and 3 show the corresponding compa-
rison of the simple docking algorithm with the
flexible-backbone algorithm for the two receptors
used in the SAMPL-1 blind docking experiment.
Because the initial ligand placement and flexible-
backbone portions of ROSETTALIGAND were deve-
loped later, our actual submitted predictions for
SAMPL were made with the simpler algorithm; the

386

ROSETTALIGAND Flexible Receptor Docking

Table 3. Impact of initial ligand placement and receptor
backbone flexibility on urokinase targets from the
SAMPL-1 blind docking challenge

SAMPL-1
predictions

RMS
of best Rank b 2 Å

3
1
1
NA
3
1
5
34
1
1
1
1
2
3
2
2
5
37
NA
1
14
1
1
1
1
NA
2

3.27
1.01
0.76
3.78
5.59
1.46
2.34
3.28
1.16
0.72
1.48
0.52
2.38
2.94
2.09
2.17
3.83
8.27
3.75
0.58
2.41
1.31
1.45
0.62
1.17
4.11
2.12
0.44
0.70
2.39

Flexible backbone
RMS
of best Rank b 2 Å
2.19
1.19
1.04
2.27
5.85
0.80
2.17
7.39
1.95
0.54
2.03
0.64
2.10
2.56
1.40
2.21
3.50
7.93
4.33
0.43
3.09
0.67
1.70
0.59
3.04
2.22
1.98
0.44
0.74
2.44

16
1
1
81
10
1
13
NA
3
1
NA
1
11
15
1
NA
50
49
NA
1
10
1
3
1
5
49
2

Compound Torsions
uk.pp.1-1
uk.pp.1-2
uk.pp.1-3
uk.pp.1-5
uk.pp.1-6
uk.pp.1-7
uk.pp.1-8
uk.pp.1-9
uk.pp.1-10
uk.pp.1-11
uk.pp.1-13
uk.pp.1-14
uk.pp.1-15
uk.pp.1-16
uk.pp.1-18
uk.pp.1-19
uk.pp.1-20
uk.pp.1-21
uk.pp.1-22
uk.pp.1-23
uk.pp.1-24
uk.pp.1-25
uk.pp.1-29
uk.pp.1-30
uk.pp.1-31
uk.pp.1-32
uk.pp.1-34
#1 b 2 Å
#1 b 3 Å
Avg. RMS

0
5
6
4
3
3
3
8
3
1
5
1
4
5
2
4
6
3
8
1
3
2
6
3
4
3
4

See Table 2 for details.

flexible-backbone algorithm was evaluated after the
fact.

Adding in the initial shape-complementarity
search and receptor backbone flexibility was quite
beneficial for the JNK3 kinase ligands, but had
virtually no effect on the urokinase ligands. For
JNK3, more predictions are within 2 Å of native and
the average RMSD is lower. Also, the five com-
pounds that had to be positioned manually with the
original algorithm now find their native binding
modes without any intervention. For the most part,
the JNK3 binding site is rigid. Two representative
receptor structures were provided, and although
several nonpolar side chains change rotamer, the
overall change in the shape and electrostatics of the
binding site are minimal. However, Fig. 1c shows an
example of a binding mode that would not have
been discovered with a rigid receptor model. This
compound does not make the backbone hydrogen
bonds that most of the others do, and instead is held
in place by side-chain hydrogen bonds to Lys93 and
Asn152. Asn152 is not positioned correctly to make
this interaction in either of the representative struc-
tures, but Rosetta's repacking algorithm discovers
the correct conformation and,
the correct
binding mode. Other successful cases of mandatory
side-chain repacking were previously described;9

thus,

the new ROSETTALIGAND continues to treat them
successfully.

For urokinase, on the other hand, some com-
pounds fare worse and some fare better, but on ave-
rage the performance is unchanged. Figure 3a and b
show a representative docking success and failure,
respectively, for this system. The success accurately
captures all the key interactions, but in the failed case
the compound is buried too deeply in the receptor. In
one low-energy case it occupies a pocket that should
hold a buried water molecule (water molecules are
not modeled in our protocol), and in another it dis-
places a tyrosine side chain. Since this receptor does
not change conformation appreciably upon binding,
allowing receptor flexibility introduces opportu-
nities for this kind of mistake.

Comparison to other methods

To aid comparison, we have docked the Meiler
and Baker set with AutoDock 4.0.10 AutoDock is
among the most used docking programs2 and is
available under an open-source license‡. Parameters
were as recommended by the authors' online tuto-
rial: 60 × 60 × 60 grid points spaced 0.375 Å apart, 25
million energy evaluations per run, and 50 runs of
the Lamarckian genetic algorithm. Other parame-
ters were set to their default values in the Auto-
DockTools graphical
interface, and the receptor
remained in its crystallized conformation. Docking
required 5–22 processor hours per compound, com-
pared to 40–80 for ROSETTALIGAND. Average RMSDs
of the top-ranked models (Table 1) are similar to the
ROSETTALIGAND rigid-backbone protocol, although
ROSETTALIGAND generated some models within 2 Å
RMSD for significantly more cases. The ROSETTALIGAND
flexible-backbone protocol performs better than
AutoDock by both criteria. (These findings should be
interpreted cautiously, as we are not experts in using
AutoDock; better performance is likely possible.)

At the request of a reviewer, we have also tested
the full ROSETTALIGAND flexible-backbone protocol
against the Astex Diverse Set11 to facilitate compar-
ison with other docking tools. The Astex Diverse Set
contains only self-docking problems; as such, the
receptor flexibility allowed by ROSETTALIGAND be-
comes a disadvantage. Nonetheless, the top-scoring
pose was positioned within 2 Å RMSD in 58% of
cases, with additional near misses: one of the top three
poses was within 2 Å in 73% of cases, and the top pose
was within 3 Å in 71% of cases (see Table 4). By
comparison, GOLD docks 75% of these compounds
within 2 Å RMSD.11 When the experimentally
determined ligand geometry is used, GOLD
improves to 80–99% correct, and ROSETTALIGAND
improves to 99% correct, suggesting that ligand
conformer generation is the limiting factor. Thus, it
appears that ROSETTALIGAND maintains reasonable
performance on self-docking tests while offering

‡ http://autodock.scripps.edu

ROSETTALIGAND Flexible Receptor Docking

387

Fig. 3. Examples of docking against urokinase. (a) Compound 3 demonstrates a typical successful docking, with the
lowest-energy poses (dark circles) similar in RMSD and energy to the minimized native structure (black dots). (b)
Compound 6 illustrates a failed docking, in which the flexibility allowed by ROSETTALIGAND permits the ligand to
penetrate too deeply into the receptor (cyan, purple) compared to the true binding mode (green).

additional benefits for more difficult cross-docking
scenarios.

Discussion

Overall, we find that the top-scoring ligand pose
is correctly positioned within 2 Å RMSD for 64%
(54/85) of cross-docking scenarios. To put this in
context, Warren et al. studied 19 docking protocols
on a diverse set of cross-docking scenarios and
found that when considering only the top-scoring
pose, even the best program for each receptor
rarely placed more than ∼60% of compounds
within 2 Å RMSD, and on average, each program
did significantly worse.12 While it is difficult to
meaningfully compare different docking studies,
ROSETTALIGAND does show promise for accurate
docking in real-world conditions, particularly for

receptors with a moderate amount of structural
plasticity.

The current version of ROSETTALIGAND captures
much of the possible conformational variation in
small molecules, but those with more than 8–10
rotatable bonds still present a significant challenge.
Figure 1b shows docking results for the 1pq6
ligand, with 14 rotatable bonds. Although the
docked poses occupy the correct pocket in approxi-
mately the correct orientation, the details of the
interaction are mostly wrong. In part, this is a
limitation of a pre-generated conformer library:
even with explicit
ligand
degrees of freedom, a few hundred or thousand
conformers are not adequate to explore such a large
conformation space. (The nearest conformer has
an RMSD of 1.7 Å to the native, making a docking
within 2 Å nearly impossible.) Thus, future work
will consider generating new conformers on the fly,

local optimization of

388

ROSETTALIGAND Flexible Receptor Docking

Table 4. Results for the Astex Diverse Set of self-docking
cases

PDB code
1g9v
1gkc
1gm8
1gpk
1hnn
1hp0
1hq2
1hvy
1hwi
1hww
1ia1
1ig3
1j3j
1jd0
1jje
1jla
1k3u
1ke5
1kzk
1l2s
1l7f
1lpz
1lrh
1m2z
1meh
1mmv
1mzc
1n1m
1n2j
1n2v
1n46
1nav
1of1
1of6
1opk
1oq5
1owe
1oyt
1p2y
1p62
1pmn
1q1g
1q41
1q4g
1r1h
1r55
1r58
1r9o
1s19
1s3v
1sg0
1sj0
1sq5
1sqn
1t40
1t46
1t9b
1tow
1tt1
1tz8
1u1c
1u4d
1uml
1unl
1uou
1v0p
1v48
1v4s
1vcj
1w1p

Omega only

Omega+ xtal geometry
RMS of #1 Rank b 2 Å RMS of #1 Rank b 2 Å

7.23
1.32
3.03
3.68
1.12
1.65
1.02
2.46
0.72
3.84
0.47
1.48
0.34
5.49
8.03
0.84
2.75
0.46
0.28
1.04
1.55
3.65
2.14
0.40
1.66
1.70
8.90
2.36
4.29
1.82
0.60
0.65
0.61
0.57
1.83
1.45
2.36
0.73
1.01
2.83
0.86
6.38
1.92
0.92
1.74
1.60
3.13
7.93
0.90
0.53
0.52
4.95
5.71
1.36
5.88
0.42
1.66
3.44
0.28
2.38
1.03
0.78
7.67
0.71
1.44
1.26
2.35
1.00
4.22
3.03

25
1
68
2
1
1
1
NA
1
2
1
1
1
40
31
1
2
1
1
1
1
NA
3
1
1
1
NA
2
44
1
1
1
1
1
1
1
7
1
1
2
1
69
1
1
1
1
3
2
1
1
1
NA
4
1
NA
1
1
6
1
2
1
1
NA
1
1
1
5
1
35
18

0.30
0.24
3.08
0.22
0.72
0.80
0.23
0.59
0.31
0.58
0.26
0.53
0.40
1.12
0.28
0.35
0.31
0.25
0.17
1.03
0.23
0.34
0.38
0.33
0.64
0.40
0.26
0.78
0.37
0.33
0.23
0.22
0.22
0.24
0.17
0.47
0.23
0.33
0.58
0.32
0.56
0.35
0.33
0.37
0.30
0.15
0.68
0.59
0.30
0.19
0.30
0.35
0.56
0.12
0.23
0.21
0.62
0.68
0.12
0.36
0.14
0.55
0.36
0.29
0.28
0.22
0.35
0.38
0.71
0.56

1
1
184
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

Table 4 (continued)

PDB code
1w2g
1x8x
1xm6
1xoq
1xoz
1y6b
1ygc
1yqy
1yv3
1yvf
1ywr
1z95
2bm2
2br1
2bsm
#1 b 2 Å
#(1–3) b 2 Å
#1 b 3 Å
Avg. RMS

Omega only

Omega+ xtal geometry
RMS of #1 Rank b 2 Å RMS of #1 Rank b 2 Å

2.28
3.56
2.26
8.08
6.99
5.17
3.08
1.02
0.38
2.82
0.59
7.87
1.36
1.03
0.61
0.58
0.73
0.71
2.49

3
6
3
30
2
NA
11
1
1
2
1
5
1
1
1

1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

0.33
0.18
0.26
0.63
0.27
0.24
0.50
0.25
0.28
0.36
0.55
0.28
0.34
0.40
0.19
0.99
0.99
0.99
0.41

The full ROSETTALIGAND protocol including backbone flexibility
was used. Dockings were performed either with the ligand
conformers generated by Omega (“Omega only”) or with those
conformers plus the experimentally observed conformation of the
co-crystallized ligand (“Omega+ xtal geometry”). “RMS of #1”
denotes the RMSD of ligand heavy-atom positions versus the
crystal structure for the best-scoring docked pose. “Rank b2 Å”
gives the rank of the first pose to be within 2 Å RMSD of the
crystal structure; some pairs did not have a pose under 2 Å within
the top 5% of structures produced.

as well as incremental ligand-building strategies (K.
Kaufmann and J. Meiler, unpublished results).

The core ROSETTA algorithms and energy func-
tion have been successfully applied in various
problems where an entire protein is flexible.13,14
However, we found that unconstrained minimiza-
tion of the receptor backbone impaired discrimina-
tion between native and nonnative poses; other
authors report similar findings.15 On the other
hand, we found that constrained minimization
produced better results than simply softening the
repulsive potential (data not shown). For example,
using ROSETTA's soft-repulsive potential with a
rigid backbone leads to the same nonnative pose
for the 1dm2/1aq1 case as the hard-repulsive
potential with a rigid backbone does (Fig. 2); per-
formance for other cases is also similar to the hard-
repulsive potential. Similar observations have pre-
viously been made for high-resolution structure
prediction,13 protein design,14 and protein–protein
docking.16 Although successful docking into highly
flexible receptors (such as HIV-1 protease) or
homology models will require more flexibility
than constrained minimization can offer, it appears
to be a useful technique for receptors with more
modest backbone changes.

As expected, incorporating so much conforma-
tional flexibility into ROSETTALIGAND requires con-
siderable computational expense, typically 40–80
processor hours for the cases presented here.
Obviously, the method is not suited to large-scale
virtual screening applications, but its requirements

ROSETTALIGAND Flexible Receptor Docking

389

are similar to those of other programs that allow
substantial protein flexibility. For example, Glide/
Prime requires 30 min per compound on a cluster of
20 processors,6 while ROSETTALIGAND requires 2–4 h
on the same cluster. Furthermore, Glide/Prime
cannot use more than 20 processors, while ROSETTA-
LIGAND calculations scale linearly with the number of
processors available. There are also ways to make the
ROSETTALIGAND calculations faster. Reducing the
translational search from 5 Å to 3 Å would allow
the same density of sampling in fivefold less time,
albeit over a smaller volume. Ligands with few
rotatable bonds present a smaller search space and so
require several times less than 5000 trajectories to
sample the correct binding mode; the larger number
was used for all cases here simply for uniformity.
Finally, foreknowledge of likely binding modes or
specific interactions can be input as atom–atom
distance or angle restraints; the reduction in search
time depends on the specificity of the restraints.

As others have noted, retrospective assessments are
no substitute for making truly prospective pre-
dictions.1 However, we have endeavored to avoid
common pitfalls and to make the retrospective results

presented here fairly represent a real-world docking
scenario: neither the ligand's bound conformation nor
its co-crystallized receptor's structure (excepting the
17 self-docking cases) was used; the receptors were
preminimized without the ligands present to avoid
bias; and binding site definitions were made gener-
ously large to allow exploration of alternative binding
modes. Also, all side chains and backbone near the
binding site were allowed to change conformation,
rather than a few residues carefully selected from
multiple structures. Finally, no system-specific
knowledge was applied (e.g., pharmacophore con-
straints), although such knowledge is often available
in real drug-discovery exercises.

Despite these efforts, we believe that experiments
like SAMPL provide a still more stringent test and fill
a critical need within the field. The full results of the
SAMPL-1 experiment have not yet been released,
so we are unable to make a detailed comparison
between the performance of ROSETTALIGAND and
other docking software; in any case, performance on
just two receptors is not enough to make statistically
valid comparisons. Nevertheless, it provides a pro-
mising indication of ROSETTALIGAND's potential. There

Fig. 4. Flowchart of the ROSETTA-
LIGAND docking algorithm. See
Materials and Methods for details.
Each trajectory takes approximately
30–60 s, with 2–3 s spent on initial
placement, about 10 s spent on the
final minimization, and the remain-
der spent on the DockMCM search.

390

ROSETTALIGAND Flexible Receptor Docking

is, however, still much work to be done to improve the
method, particularly in ranking the affinity and
predicting the binding energy of diverse ligands.

Materials and Methods

Three stages of the docking algorithm

Our docking algorithm is based on the ROSETTALIGAND
method described by Meiler and Baker,9 but with en-
hancements that make it faster and more accurate. It also
samples internal degrees of freedom in the ligand and
protein backbone,
in addition to the rigid-body and
protein side-chain degrees of freedom sampled in the
original ROSETTALIGAND. The protocol
is comprised of
three stages, which progress from coarse-grained sam-
pling and scoring to fine optimization and a detailed all-
atom energy function (Fig. 4). In the first, coarse-grained
stage, the ligand is placed randomly within the binding
site: a selected “neighbor atom” (usually one of the
centermost atoms) is constrained to lie within a 10 Å
diameter sphere. Each conformer is superimposed on the
neighbor atom, rotated as a rigid body into 1000 random
orientations, and scored for shape compatibility with the
receptor. We define a shape complementarity score S as
follows: If there are N total ligand atoms, R ligand atoms
within 2.25 Å of the receptor backbone or Cβs (repulsive
clashes), and A ligand atoms between 2.25 and 4.75 Å of
any receptor atom (attractive contacts), then S=R−min
(A/N, 0.85). More negative scores are better. Only heavy
atoms are considered, and receptor side chains are ignored
for the repulsive term R because they may move
significantly during docking. The attractive contact count
A is capped at 85% of its maximum, with the expectation
that in the native complex up to 15% of ligand atoms will
project into solvent or through the unbound positions of
receptor side chains. Typically, dozens of ligand poses are
found with “perfect” scores—no clashes and ≥85% good
p
contacts. The best-scoring poses are filtered by RMSD to
eliminate near-duplicates, with a threshold of 0:65 ﬃﬃﬃﬃN
Å,
where N is the number of nonhydrogen ligand atoms
(although a wide range of values produced acceptable
results). Finally, one of the remaining poses is selected at
random to continue this trajectory.

The second, high-resolution stage employs the Monte
Carlo minimization (MCM) scheme from the original
ROSETTALIGAND: the ligand position and orientation are
randomly perturbed by a small amount (normal distribu-
tions with σ 0.1 Å and 3°); receptor side chains are re-
packed using a rotamer library;
the ligand position,
orientation, and torsions and protein side-chain torsions
are simultaneously optimized using quasi-Newton mini-
mization; and the end result is accepted or rejected based
on the Metropolis criterion (kT =2). Scoring uses the full-
atom ROSETTA energy function with softened van der
Waals repulsion and the weights described previously,9
except that hydrogen bonding was downweighted from
2.0 to 1.3 based on our experience designing enzymes.17,18
This MCM process is repeated for 6 cycles rather than the
50 cycles used originally because it was found most
trajectories converge very early. The side-chain rotamers
are searched simultaneously in cycles 1 and 4 (“full
repack”) and one at a time in the remaining cycles
(“rotamer trials”). Both rotamer algorithms are stochastic
and are described elsewhere.19,20 Briefly, the full repack
makes ∼106 random rotamer substitutions at random
positions and accepts or rejects each on the Metropolis

criterion, as kT is lowered from 100 to 0.3. Rotamer trials
chooses the single best rotamer at a position in the context
of the current state of the rest of the system, with the
positions visited once each in random order. The ligand is
treated as a single residue, and its input conformers serve
as rotamers here. The minimization step, finely sampled
rotamer library, and soft-repulsive energy function allow
access to off-rotamer conformations.

The third and final stage is a more stringent gradient-
based minimization of the ligand position, orientation,
and torsions and the receptor torsions for both side chains
and backbone. Scoring uses the same ROSETTA energy
function, but with a hard-repulsive van der Waals poten-
tial (see below); this creates a more rugged energy land-
scape that is less suited to the search stage (above), but is
better at discriminating native from nonnative binding
modes. Consistent with the experiences of other groups15
and our own work on protein–protein docking,21,22 we
find that the experimental apo structure contains informa-
tion not fully captured by our energy function. As a result,
we place harmonic restraints on the receptor Cα atoms,
and we follow Wang et al.22 in not penalizing the native
side chain conformations (energy equal to the statistically
best side chain conformation at that position).

As shown in the Results section, both the initial shape
complementarity screen and the final minimization of
the receptor backbone make important contributions
toward accurate docking. In simplified protocols where
the shape complementarity step is omitted, the ligand is
placed in a random conformation, orientation, and loca-
tion with its centroid within 5 Å of the native centroid.
In simplified protocols where the backbone is held
rigid, the final minimization includes all non-backbone
degrees of freedom.

The coarse-grained first step of

the protocol may
appear wasteful in that only one pose is carried forward
when a few tens of poses score equally well, and because
similar poses may be explored by multiple trajectories.
However, the first step takes only 3–10% of the time for
each trajectory, and by not requiring multiple processes to
communicate, we can easily achieve linear scaling with
the number of available processors. This enables us to use
thousands of processors simultaneously,
if desired,
including distributed computing schemes such as Roset-
ta@home§. Furthermore, we find empirically that re-
peated discovery of a low-energy pose in multiple
trajectories provides partial evidence that that pose is in
fact the correct native structure, both for ROSETTALIGAND
and for other ROSETTA protocols.

All-atom ROSETTA scoring function

The ROSETTA scoring function used in the second and
third stages consists of a weighted sum of physical and
knowledge-based terms calculated from the three-dimen-
sional coordinates of the receptor and ligand, including
all hydrogen atoms. The function and its uses have
recently been reviewed in Ref. 23 and a fuller description
appears in Ref. 14; considerations specific to ligand
docking are discussed in Ref. 9. In brief, the ROSETTA
energy E with weights w is given by E =w·(Evdw, Esol, Ehb,
Esor, Eelec, Erestr). Evdw is the Lennard–Jones 6–12 van der
Waals energy; however, the function switches to linear at
60% or 91% of the ideal contact distance (hard- and soft-
to prevent extreme
repulsive forms, respectively)

§ http://boinc.bakerlab.org

ROSETTALIGAND Flexible Receptor Docking

391

energies from large clashes. Esol is the electrostatic and
hydrophobic desolvation energies calculated by Lazardis
and Karplus' EEF1 implicit solvation model.24 Ehb is an
orientation-dependent hydrogen-bonding term derived
from statistics of structures in the Protein Data Bank
(PDB) and quantum mechanics calculations.25,26 Etor is
protein side-chain and backbone torsional potentials
derived from the PDB.27 Eelec is a simple Coulombic
electrostatics term with linearly distance-dependent
dielectric, which is evaluated only between the receptor
and ligand.9 Erestr includes harmonic restraints to prevent
chain breaks and limit backbone movement during the
flexible-backbone minimization.

used the program Omega (v. 2.2.1, OpenEye) with its
default settings and restrained ligand torsions with a
harmonic potential while minimizing. [Future work will
consider more elaborate conformational sampling and
scoring schemes for ligands (K. Kaufmann and J. Meiler,
unpublished results).] The crystal conformation was not
included in the conformer library, as this led to artificially
high success rates. Ligand atoms were represented by the
most similar ROSETTA atom type (here determined
automatically), and partial charges were assigned by
OpenEye's AM1-BCC implementation. The methods for
conformer generation, atom typing, and partial charges
can easily be replaced by other procedures.

Analysis of docking results

Availability

For most of the results described here, we performed
5000 such docking trajectories for each receptor–ligand
pair, requiring 40–80 processor-hours on our Linux cluster.
(Integrated treatment of ligand conformers and fewer
Monte Carlo cycles make this up to 3 orders of magnitude
faster than the equivalent computations with the original
ROSETTALIGAND.) The top 5% of structures were selected by
total ROSETTA energy, and those were ranked by the
receptor–ligand interaction energy; this eliminates minor
noise from distant parts of the structure. Reported RMSDs
account for any chemical symmetry within the ligand.

Algorithm implementation and parameters

The current version of ROSETTALIGAND is based on a
new version of the ROSETTA core, rewritten from the
ground up in object-oriented C++ by our laboratory and
others. The entire receptor–ligand system is represented
as a single tree of atoms (“atom tree” or “fold tree”), in
which edges represent chemical bonds or rigid-body
transformations.23 In the calculations in this study, the
tree was constructed for docking with loop modeling.21
Nonflexible portions of the receptor backbone were held
fixed relative to one another, and together defined a
coordinate frame for rigid-body placement of the ligand.
Each flexible segment of
the receptor backbone was
randomly divided into two pieces, which were attached to
their respective flanking rigid segments. As in other
ROSETTA protocols, a pseudo-energy term was included to
maintain proper covalent geometry between the two
pieces of the divided segments during minimization.

To make large receptors tractable, a generous region
around the ligand was allowed to be flexible (typically
20–40 residues of backbone and 40–80 side chains), while
the rest of the protein was held rigid. Side chains were
included if any atom could reach within 6 Å of a ligand
atom (considering all rotamers). Backbone torsions were
varied if the Cβ was within 7 Å of a ligand atom or if it
was within 3 residues (sequence-wise) of such a residue.
Docking results were not sensitive to the exact cutoffs
used. To avoid any scoring artifacts, the entire receptor
was minimized (side chains only) before beginning.21
The ligand was not present during this prepacking step
to avoid biasing the results.

The unified internal representation of protein residues
and small molecules allows us to simultaneously opti-
mize receptor and ligand. Taking advantage of this, we
ligand conformations as “rotamers” that are
treat
sampled at the same time that protein side chains are
repacked. This allows us to dock hundreds of ligand
conformers in about the same time as a single conformer.
Currently, ligand conformers are generated externally: we

The ROSETTALIGAND source code is available through
Rosetta Commons and the University of Washington
Tech Transfer office at no cost to academic researchers.

SAMPL-1 blind docking experiment

The first annual SAMPL† was organized by Nichols and
colleagues at OpenEye Inc. in early 2008. Participation was
open to all and explicit invitations were issued to many
academic and commercial groups; participants could also
choose to submit predictions but remain anonymous in
any published results. The experiment consisted of blind
predictions on not publicly available data sets donated by
private companies. There were three stages: virtual
screening, docking, and affinity prediction; we only
submitted docking predictions. The provided inputs for
docking consisted of one structure of urokinase-type
plasminogen activator and two structures of JNK3 kinase,
both without ligands, and single 3-D structures of 34
putative urokinase ligands and 62 putative JNK3 ligands.
Some of the provided compounds were decoys that did
not actually bind these receptors. The possible presence of
decoys was revealed in advance, but not their identity or
number; compound numbers in Tables 2 and 3 are dis-
continuous due to decoys. For our blind predictions, the
three best-scoring poses for each ligand were examined
manually for consistency with observed binding patterns,
and a few JNK3 ligands were manually placed near the
assumed correct starting position. For consistency in
comparison, the lowest RMSD of the top three poses is
reported for the flexible-backbone algorithm, which was
run after the correct answers were revealed, although in
this case none of the ligands needed to be positioned
manually. Most of the results have not yet been released to
either the participants or the general public, although
OpenEye has expressed the intention to publish a
summary of the results at some point in the future.

Acknowledgements

We thank Andrew Leaver-Fay for design and
implementation of core functionality in the new
ROSETTA code base (“Mini”), Kristian Kaufmann and
Jens Meiler for many helpful conversations, and
OpenEye Inc. for providing software. I.W.D. grate-
fully acknowledges support from the University of
Washington Genome Training Grant.

392

References

1. Leach, A. R., Shoichet, B. K. & Peishoff, C. E. (2006).
Prediction of protein–ligand interactions. Docking
and scoring: successes and gaps. J. Med. Chem. 49,
5851–5855.

2. Sousa, S. F., Fernandes, P. A. & Ramos, M. J. (2006).
Protein–ligand docking: current status and future
challenges. Proteins, 65, 15–26.

3. Osterberg, F., Morris, G. M., Sanner, M. F., Olson, A. J.
& Goodsell, D. S. (2002). Automated docking to
multiple target structures: incorporation of protein
mobility and structural water heterogeneity in Auto-
Dock. Proteins, 46, 34–40.

4. Claussen, H., Buning, C., Rarey, M. & Lengauer, T.
(2001). FlexE: efficient molecular docking considering
protein structure variations. J. Mol. Biol. 308, 377–395.
5. Zhao, Y. & Sanner, M. F. (2007). FLIPDock: docking
flexible ligands into flexible receptors. Proteins, 68,
726–737.

6. Sherman, W., Day, T., Jacobson, M. P., Friesner, R. A. &
Farid, R.
(2006). Novel procedure for modeling
ligand/receptor induced fit effects. J. Med. Chem. 49,
534–553.

7. Cozzini, P., Kellogg, G. E., Spyrakis, F., Abraham, D. J.,
Costantino, G., Emerson, A. et al.
(2008). Target
flexibility: an emerging consideration in drug dis-
covery and design. J. Med. Chem. 51, 6237–6255.

8. Totrov, M. & Abagyan, R. (2008). Flexible ligand
docking to multiple receptor conformations: a prac-
tical alternative. Curr. Opin. Struct. Biol. 18, 178–184.
9. Meiler, J. & Baker, D. (2006). ROSETTALIGAND:
protein–small molecule docking with full side-chain
flexibility. Proteins, 65, 538–584.

10. Morris, G. M., Goodsell, D. S., Halliday, R. S., Huey,
R., Hart, W. E., Belew, R. K. & Olson, A. J. (1998).
Automated docking using a Lamarckian genetic
algorithm and an empirical binding free energy
function. J. Comput. Chem. 19, 1639–1662.

11. Hartshorn, M.

J., Verdonk, M. L., Chessari, G.,
Brewerton, S. C., Mooij, W. T., Mortenson, P. N. &
Murray, C. W. (2007). Diverse, high-quality test set for
the validation of protein–ligand docking perfor-
mance. J. Med. Chem. 50, 726–741.

12. Warren, G. L., Andrews, C. W., Capelli, A. M., Clarke,
B., LaLonde, J., Lambert, M. H. et al. (2006). A critical
assessment of docking programs and scoring func-
tions. J. Med. Chem. 49, 5912–5931.

13. Bradley, P., Misura, K. M. & Baker, D. (2005). Toward
high-resolution de novo structure prediction for small
proteins. Science, 309, 1868–1871.

ROSETTALIGAND Flexible Receptor Docking

14. Kuhlman, B., Dantas, G., Ireton, G. C., Varani, G.,
Stoddard, B. L. & Baker, D. (2003). Design of a novel
globular protein fold with atomic-level accuracy.
Science, 302, 1364–1368.

15. Graves, A. P., Shivakumar, D. M., Boyce, S. E.,
Jacobson, M. P., Case, D. A. & Shoichet, B. K. (2008).
Rescoring docking hit lists for model cavity sites:
predictions and experimental testing. J. Mol. Biol. 377,
914–934.

16. Gray, J. J., Moughon, S., Wang, C., Schueler-Furman,
O., Kuhlman, B., Rohl, C. A. & Baker, D. (2003).
Protein–protein docking with simultaneous optimiza-
tion of rigid-body displacement and side-chain con-
formations. J. Mol. Biol. 331, 281–299.

17. Jiang, L., Althoff, E. A., Clemente, F. R., Doyle, L.,
Rothlisberger, D., Zanghellini, A. et al. (2008). De novo
computational design of retro-aldol enzymes. Science,
319, 1387–1391.

18. Rothlisberger, D., Khersonsky, O., Wollacott, A. M.,
Jiang, L., DeChancie, J., Betker, J. et al. (2008). Kemp
elimination catalysts by computational enzyme
design. Nature, 453, 190–195.
19. Kuhlman, B. & Baker, D.

(2000). Native protein
sequences are close to optimal for their structures.
Proc. Natl Acad. Sci. USA, 97, 10383–10388.

20. Leaver-Fay, A., Kuhlman, B. & Snoeyink, J. (2005).
Workshop on Algorithms in Bioinformatics, Mallorca,
Spain.

21. Wang, C., Bradley, P. & Baker, D. (2007). Protein–
protein docking with backbone flexibility. J. Mol. Biol.
373, 503–519.

22. Wang, C., Schueler-Furman, O. & Baker, D. (2005).
Improved side-chain modeling for protein–protein
docking. Protein Sci. 14, 1328–1339.

23. Das, R. & Baker, D. (2008). Macromolecular modeling

with Rosetta. Annu. Rev. Biochem. 77, 363–382.

24. Lazaridis, T. & Karplus, M. (2000). Effective energy
functions for protein structure prediction. Curr. Opin.
Struct. Biol. 10, 139–145.

25. Kortemme, T., Morozov, A. V. & Baker, D. (2003). An
orientation-dependent hydrogen bonding potential
improves prediction of specificity and structure for
proteins and protein–protein complexes. J. Mol. Biol.
326, 1239–1259.

26. Morozov, A. V., Kortemme, T., Tsemekhman, K. &
Baker, D.
(2004). Close agreement between the
orientation dependence of hydrogen bonds observed
in protein structures and quantum mechanical calcu-
lations. Proc. Natl Acad. Sci. USA, 101, 6946–6951.

27. Dunbrack, R. L. & Cohen, F. E. (1997). Bayesian
statistical analysis of protein side-chain rotamer
preferences. Protein Sci. 6, 1661–6981.

